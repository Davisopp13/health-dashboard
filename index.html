<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sketch Health</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Crect x='15' y='15' width='170' height='170' fill='%23FEF9C3' stroke='%231E3A8A' stroke-width='2' rx='4'/%3E%3Cpath d='M100 170 C80 155, 30 120, 30 80 C30 50, 50 35, 70 35 C85 35, 95 45, 100 55 C105 45, 115 35, 130 35 C150 35, 170 50, 170 80 C170 120, 120 155, 100 170 Z' stroke='%231E3A8A' stroke-width='4' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cline x1='40' y1='100' x2='160' y2='100' stroke='%231E3A8A' stroke-width='5' stroke-linecap='round'/%3E%3Crect x='25' y='80' width='20' height='40' stroke='%231E3A8A' stroke-width='3' fill='none' rx='2'/%3E%3Cline x1='28' y1='85' x2='42' y2='115' stroke='%231E3A8A' stroke-width='1.5'/%3E%3Cline x1='32' y1='85' x2='42' y2='105' stroke='%231E3A8A' stroke-width='1.5'/%3E%3Cline x1='36' y1='85' x2='42' y2='95' stroke='%231E3A8A' stroke-width='1.5'/%3E%3Crect x='155' y='80' width='20' height='40' stroke='%231E3A8A' stroke-width='3' fill='none' rx='2'/%3E%3Cline x1='158' y1='85' x2='172' y2='115' stroke='%231E3A8A' stroke-width='1.5'/%3E%3Cline x1='162' y1='85' x2='172' y2='105' stroke='%231E3A8A' stroke-width='1.5'/%3E%3Cline x1='166' y1='85' x2='172' y2='95' stroke='%231E3A8A' stroke-width='1.5'/%3E%3Cg transform='translate(145, 40) rotate(30)'%3E%3Crect x='0' y='0' width='8' height='35' fill='%2360A5FA' stroke='%231E3A8A' stroke-width='2' rx='1'/%3E%3Cpolygon points='4,35 0,42 8,42' fill='%231E3A8A'/%3E%3Crect x='0' y='-5' width='8' height='5' fill='%2393C5FD' stroke='%231E3A8A' stroke-width='1.5'/%3E%3C/g%3E%3C/svg%3E">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kalam:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Kalam', cursive;
            background-color: #FEF9C3;
            /* Yellow notepad color */
            color: #1E3A8A;
            /* Dark blue ink color */
            background-image: repeating-linear-gradient(to bottom, transparent, transparent 28px, #BFDBFE 29px, #BFDBFE 29px);
            line-height: 29px;
            padding-top: 29px;
            /* Align content with lines */
        }

        /* Create the red margin line */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 40px;
            bottom: 0;
            width: 2px;
            background-color: #F87171;
            /* Red margin color */
        }

        .card {
            background-color: transparent;
            border: none;
            border-radius: 0;
            padding: 1.5rem;
            box-shadow: none;
        }

        .btn {
            border: 2px solid #1E3A8A;
            border-radius: 4px;
            padding: 0.5rem 1.25rem;
            font-weight: 700;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 2px 2px 0px #93C5FD;
        }

        .btn:active {
            box-shadow: 0px 0px 0px #93C5FD;
            transform: translate(2px, 2px);
        }

        .btn-primary {
            background-color: #1E3A8A;
            color: white;
        }

        .btn-primary:hover {
            background-color: #1D4ED8;
        }

        .btn-secondary {
            background-color: transparent;
            color: #1E3A8A;
        }

        .btn-secondary:hover {
            background-color: rgba(191, 219, 254, 0.3);
        }

        .btn-danger {
            background-color: #1E3A8A;
            color: white;
        }

        .btn-danger:hover {
            background-color: #1D4ED8;
        }

        .progress-bar {
            background-color: rgba(191, 219, 254, 0.4);
            border: 1px solid #60A5FA;
            border-radius: 2px;
            overflow: hidden;
            height: 1.25rem;
        }

        .progress-bar-fill {
            background-color: #60A5FA;
            /* Blue highlighter */
        }

        input,
        select {
            font-family: 'Kalam', cursive;
            border: 2px solid #1E3A8A;
            border-radius: 4px;
            background-color: #FEFCE8;
            /* Slightly lighter yellow for inputs */
        }

        input[type="checkbox"]:checked+span {
            text-decoration: line-through;
            color: #6B7280;
        }

        input[type="checkbox"] {
            appearance: none;
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            background-color: transparent;
            border: 2px solid #1E3A8A;
            border-radius: 2px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        input[type="checkbox"]:after {
            content: 'âœ“';
            font-size: 18px;
            font-weight: 700;
            color: #1E3A8A;
            display: none;
        }

        input[type="checkbox"]:checked:after {
            display: block;
        }

        .tab-btn {
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }

        .tab-btn.active {
            background-color: #1E3A8A;
            color: white;
            border: 2px solid #1E3A8A;
        }

        .tab-btn:not(.active) {
            color: #1D4ED8;
        }

        /* Custom styles for overriding Tailwind inside notepad */
        .notepad-text {
            color: #1E3A8A;
        }

        .notepad-text-light {
            color: #3B82F6;
        }

        .notepad-text-faded {
            color: #60A5FA;
        }

        .notepad-header {
            color: #1E3A8A;
        }
    </style>
</head>

<body class="py-4 sm:py-6 md:py-8 pr-4 sm:pr-6 md:pr-8 pl-16 md:pl-20">

    <div id="loading-container" class="fixed inset-0 bg-yellow-100 flex items-center justify-center z-50">
        <div class="text-center">
            <svg class="animate-spin h-10 w-10 text-blue-800 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none"
                viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                </path>
            </svg>
            <p class="mt-4 text-lg text-blue-700">Loading...</p>
        </div>
    </div>

    <div id="landing-page-container" class="hidden">
        <div class="min-h-screen flex flex-col items-center justify-center text-center px-4">
            <!-- Logo Icon - Heart with Heartbeat -->
            <svg class="w-32 h-32 md:w-40 md:h-40 mb-4" viewBox="0 0 200 200" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <!-- Heart outline -->
                <path
                    d="M100 170 C80 155, 30 120, 30 80 C30 50, 50 35, 70 35 C85 35, 95 45, 100 55 C105 45, 115 35, 130 35 C150 35, 170 50, 170 80 C170 120, 120 155, 100 170 Z"
                    stroke="#1E3A8A" stroke-width="4" fill="none" stroke-linecap="round" stroke-linejoin="round" />
                <!-- Heartbeat/ECG line through center -->
                <polyline points="30,100 75,100 82,85 88,115 94,100 165,100" stroke="#1E3A8A" stroke-width="3"
                    fill="none" stroke-linecap="round" stroke-linejoin="round" />
            </svg>

            <h1 class="text-6xl md:text-7xl font-bold notepad-header leading-tight">
                Sketch Health
            </h1>
            <p class="mt-4 max-w-2xl text-lg text-blue-700">
                Your personal health journey, sketched out. Track workouts, monitor nutrition with AI, and build lasting
                habits.
            </p>
            <div class="mt-8 flex flex-col sm:flex-row items-center justify-center gap-4">
                <button id="googleSignUpBtn" class="btn btn-primary w-full sm:w-auto text-lg px-8 py-3">
                    Sign Up for Free
                </button>
            </div>
            <p class="mt-4 text-sm text-gray-500">
                Already have an account?
                <button id="googleSignInBtn" class="text-blue-800 hover:text-blue-600 font-bold">Log in</button>
            </p>
            <div id="auth-error" class="text-red-600 mt-4 text-sm h-5"></div>
        </div>
    </div>

    <div id="app-container" class="max-w-7xl mx-auto hidden">
        <!-- Header -->
        <header class="mb-6">
            <div class="border border-blue-100 rounded-xl px-6 py-4 shadow-sm">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <!-- Heart + Dumbbell + Pencil Logo -->
                        <svg class="w-8 h-8 flex-shrink-0" viewBox="0 0 200 200" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <!-- Heart outline -->
                            <path
                                d="M100 170 C80 155, 30 120, 30 80 C30 50, 50 35, 70 35 C85 35, 95 45, 100 55 C105 45, 115 35, 130 35 C150 35, 170 50, 170 80 C170 120, 120 155, 100 170 Z"
                                stroke="#1E3A8A" stroke-width="4" fill="none" stroke-linecap="round"
                                stroke-linejoin="round" />
                            <!-- Barbell bar -->
                            <line x1="40" y1="100" x2="160" y2="100" stroke="#1E3A8A" stroke-width="5"
                                stroke-linecap="round" />
                            <!-- Left weight plate -->
                            <rect x="25" y="80" width="20" height="40" stroke="#1E3A8A" stroke-width="3" fill="none"
                                rx="2" />
                            <line x1="28" y1="85" x2="42" y2="115" stroke="#1E3A8A" stroke-width="1.5" />
                            <line x1="32" y1="85" x2="42" y2="105" stroke="#1E3A8A" stroke-width="1.5" />
                            <line x1="36" y1="85" x2="42" y2="95" stroke="#1E3A8A" stroke-width="1.5" />
                            <!-- Right weight plate -->
                            <rect x="155" y="80" width="20" height="40" stroke="#1E3A8A" stroke-width="3" fill="none"
                                rx="2" />
                            <line x1="158" y1="85" x2="172" y2="115" stroke="#1E3A8A" stroke-width="1.5" />
                            <line x1="162" y1="85" x2="172" y2="105" stroke="#1E3A8A" stroke-width="1.5" />
                            <line x1="166" y1="85" x2="172" y2="95" stroke="#1E3A8A" stroke-width="1.5" />
                            <!-- Pencil in upper right -->
                            <g transform="translate(145, 40) rotate(30)">
                                <rect x="0" y="0" width="8" height="35" fill="#60A5FA" stroke="#1E3A8A" stroke-width="2"
                                    rx="1" />
                                <polygon points="4,35 0,42 8,42" fill="#1E3A8A" />
                                <rect x="0" y="-5" width="8" height="5" fill="#93C5FD" stroke="#1E3A8A"
                                    stroke-width="1.5" />
                            </g>
                        </svg>
                        <h1 class="text-2xl font-bold notepad-header">Sketch Health</h1>
                    </div>
                    <div class="flex items-center gap-4">
                        <p id="welcomeMessage" class="text-base font-semibold text-blue-700 hidden sm:block">Welcome
                            back, Davis!</p>
                        <!-- User Profile Icon with Dropdown -->
                        <div class="relative">
                            <button id="profileBtn"
                                class="w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold hover:bg-blue-700 transition-colors">
                                D
                            </button>
                            <div id="profileDropdown"
                                class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border-2 border-blue-800 py-2 z-10">
                                <button id="logoutBtn"
                                    class="w-full text-left px-4 py-2 hover:bg-blue-50 text-blue-900 font-semibold">
                                    Log out
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-4">
                <div class="h-px bg-gray-200"></div>
            </div>
        </header>

        <!-- Highlights Bar -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-6">
            <div class="card flex items-center justify-between">
                <div>
                    <h2 class="font-bold text-xl mb-2 notepad-header">Workout Streak</h2>
                    <p id="lastWorkoutDate" class="text-sm text-blue-400 mt-1">No workouts yet.</p>
                </div>
                <div class="flex items-baseline text-right">
                    <span id="workoutStreakDisplay" class="text-6xl font-bold notepad-header">0</span>
                    <span class="text-xl font-semibold ml-2 text-blue-700">Days</span>
                </div>
            </div>
            <div class="card flex items-center justify-between">
                <div>
                    <h2 class="font-bold text-xl mb-2 notepad-header">Total Excess Calories</h2>
                    <p class="text-sm text-blue-400 mt-1">Logged from snacks & extras.</p>
                </div>
                <div class="flex items-baseline text-right">
                    <span id="excessCaloriesDisplay" class="text-6xl font-bold notepad-header">0</span>
                    <span class="text-xl font-semibold ml-2 text-blue-700">kcal</span>
                </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <main class="grid grid-cols-1 lg:grid-cols-5 gap-6">
            <div class="lg:col-span-3 space-y-6">
                <div class="card p-6">
                    <div>
                        <h2 class="font-bold text-xl mb-4 notepad-header">Today's Workouts</h2>
                        <div class="mb-4">
                            <select id="workoutSelector" class="w-full px-3 py-2">
                                <option value="none">-- Add a workout to your day --</option>
                                <option value="home_abs">Home Ab Workout (15 Mins)</option>
                                <option value="gym_push">Gym: Push Day (45 Mins)</option>
                                <option value="gym_pull">Gym: Pull Day (45 Mins)</option>
                                <option value="gym_legs">Gym: Legs Day (45 Mins)</option>
                                <option value="cardio">Cardio</option>
                                <option value="rest_day">Rest Day</option>
                            </select>
                        </div>
                        <div id="workoutStack" class="space-y-6"></div>
                    </div>
                    <hr class="border-blue-200 my-8">
                    <div>
                        <h2 class="font-bold text-xl mb-4 notepad-header">Log Excess Calories with AI</h2>
                        <div class="flex flex-col sm:flex-row gap-4 mb-4">
                            <input id="excessDescInput" type="text" placeholder="Describe the food..."
                                class="px-3 py-2 w-full">
                            <button id="logExcessBtn" class="btn btn-primary" onclick="app.addExcessCalories()">
                                <span id="logExcessText">Calculate & Log</span>
                                <svg id="logExcessSpinner" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white hidden"
                                    xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                        stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor"
                                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                    </path>
                                </svg>
                            </button>
                        </div>
                        <div id="excessList" class="space-y-2 text-sm text-blue-700"></div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-2 space-y-6">
                <div class="card p-6">
                    <h2 class="font-bold text-xl mb-4 notepad-header">Nutrition Hub</h2>
                    <div class="mb-6">
                        <h3 class="font-semibold notepad-header mb-2">Liquid Calories</h3>
                        <p class="text-2xl font-bold notepad-header"><span id="liquidCaloriesDisplay">0</span> / 500
                            kcal</p>
                        <div class="progress-bar mt-2 mb-4">
                            <div id="liquidCaloriesBar" class="progress-bar-fill" style="width: 0%;"></div>
                        </div>
                        <div class="grid grid-cols-2 gap-3 text-sm">
                            <button class="btn btn-secondary" onclick="app.addLiquidCalories(150)">Soda (150)</button>
                            <button class="btn btn-secondary" onclick="app.addLiquidCalories(120)">Juice (120)</button>
                            <button class="btn btn-secondary" onclick="app.addLiquidCalories(210)">Choc. Milk
                                (210)</button>
                            <button class="btn btn-secondary" onclick="app.addLiquidCalories(180)">Latte (180)</button>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold notepad-header mb-2">Water Intake</h3>
                        <p class="text-2xl font-bold notepad-header"><span id="waterIntakeDisplay">0</span> / 8 Glasses
                        </p>
                        <div class="progress-bar mt-2 mb-4">
                            <div id="waterIntakeBar" class="progress-bar-fill" style="width: 0%;"></div>
                        </div>
                        <div class="flex"><button class="btn btn-secondary w-full" onclick="app.addWater(1)">+1
                                Glass</button></div>
                    </div>
                </div>
            </div>
        </main>

        <section id="historical-log" class="mt-6">
            <div class="card">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold notepad-header">Historical Log</h2>
                    <div class="flex space-x-2 bg-blue-100 p-1 rounded-md">
                        <button id="dailyTabBtn" class="tab-btn active">Daily</button>
                        <button id="weeklyTabBtn" class="tab-btn">Weekly</button>
                    </div>
                </div>
                <div id="dailyTabView" class="tab-content active">
                    <div class="flex items-center space-x-4 mb-4">
                        <label for="date-picker">Select a date:</label>
                        <input type="date" id="date-picker" class="px-3 py-1">
                    </div>
                    <div id="daily-log-content">
                        <p class="text-center text-blue-400">Select a date to view its log.</p>
                    </div>
                </div>
                <div id="weeklyTabView" class="tab-content">
                    <div id="weekly-log-content"></div>
                </div>
            </div>
        </section>
    </div>

    <!-- Timer Modal -->
    <div id="timerModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg p-8 text-center w-80 transform transition-all border-4 border-blue-800"
            style="transform: scale(0.95); opacity: 0;">
            <h2 id="timerExerciseName" class="text-2xl font-bold mb-4 text-blue-900">Plank</h2>
            <div id="timerDisplay" class="text-8xl font-bold text-blue-800 my-8">60</div>
            <div class="flex justify-center space-x-4">
                <button id="timerControlBtn" class="btn btn-primary w-32 text-lg">Start</button>
                <button id="timerResetBtn" class="btn btn-secondary w-32 text-lg">Reset</button>
            </div>
            <button id="timerDoneBtn" class="btn btn-secondary w-full mt-6">Done</button>
        </div>
    </div>


    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, onSnapshot, setDoc, getDoc, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const appUI = {
            loadingContainer: document.getElementById('loading-container'),
            landingPageContainer: document.getElementById('landing-page-container'),
            appContainer: document.getElementById('app-container'),
            logoutBtn: document.getElementById('logoutBtn'),
            googleSignUpBtn: document.getElementById('googleSignUpBtn'),
            googleSignInBtn: document.getElementById('googleSignInBtn'),
            authError: document.getElementById('auth-error'),
            workoutSelector: document.getElementById('workoutSelector'),
            workoutStack: document.getElementById('workoutStack'),
            liquidCaloriesDisplay: document.getElementById('liquidCaloriesDisplay'),
            liquidCaloriesBar: document.getElementById('liquidCaloriesBar'),
            waterIntakeDisplay: document.getElementById('waterIntakeDisplay'),
            waterIntakeBar: document.getElementById('waterIntakeBar'),
            workoutStreakDisplay: document.getElementById('workoutStreakDisplay'),
            lastWorkoutDate: document.getElementById('lastWorkoutDate'),
            excessCaloriesDisplay: document.getElementById('excessCaloriesDisplay'),
            excessList: document.getElementById('excessList'),
            dailyTabBtn: document.getElementById('dailyTabBtn'),
            weeklyTabBtn: document.getElementById('weeklyTabBtn'),
            dailyTabView: document.getElementById('dailyTabView'),
            weeklyTabView: document.getElementById('weeklyTabView'),
            datePicker: document.getElementById('date-picker'),
            dailyLogContent: document.getElementById('daily-log-content'),
            weeklyLogContent: document.getElementById('weekly-log-content'),
            timerModal: document.getElementById('timerModal'), timerExerciseName: document.getElementById('timerExerciseName'), timerDisplay: document.getElementById('timerDisplay'), timerControlBtn: document.getElementById('timerControlBtn'), timerResetBtn: document.getElementById('timerResetBtn'), timerDoneBtn: document.getElementById('timerDoneBtn'),
        };

        const app = {
            db: null, auth: null, userId: null, unsubscribe: null, userProfileUnsubscribe: null, todayState: {}, userProfile: {},
            timerInterval: null, timerSecondsLeft: 0, timerOriginalSeconds: 0, isTimerRunning: false, currentTimerExercise: null,
            workouts: { home_abs: { name: 'Home Ab Workout', duration: '15 Mins', exercises: [{ name: 'Push Ups', sets: 3, reps: '10-15' }, { name: 'Crunches', sets: 3, reps: 20 }, { name: 'Leg Raises', sets: 3, reps: 15 }, { name: 'Plank', sets: 3, reps: '60s hold' }, { name: 'Russian Twists', sets: 3, reps: '20 (each side)' },] }, gym_push: { name: 'Gym: Push Day', duration: '45 Mins', exercises: [{ name: 'Bench Press', sets: 3, reps: '8-12' }, { name: 'Overhead Press', sets: 3, reps: '8-12' }, { name: 'Incline DB Press', sets: 3, reps: '10-15' }, { name: 'Tricep Pushdowns', sets: 3, reps: '12-15' }, { name: 'Lateral Raises', sets: 4, reps: '12-15' },] }, gym_pull: { name: 'Gym: Pull Day', duration: '45 Mins', exercises: [{ name: 'Pull-Ups / Lat Pulldowns', sets: 3, reps: '8-12' }, { name: 'Bent-Over Rows', sets: 3, reps: '8-12' }, { name: 'Face Pulls', sets: 3, reps: '15-20' }, { name: 'Bicep Curls', sets: 3, reps: '12-15' },] }, gym_legs: { name: 'Gym: Legs Day', duration: '45 Mins', exercises: [{ name: 'Squats', sets: 3, reps: '8-12' }, { name: 'Romanian Deadlifts', sets: 3, reps: '10-12' }, { name: 'Leg Press', sets: 3, reps: '12-15' }, { name: 'Leg Curls', sets: 3, reps: '12-15' }, { name: 'Calf Raises', sets: 4, reps: '15-20' },] }, cardio: { name: 'Cardio' }, rest_day: { name: 'Rest Day' }, },

            async init() {
                const firebaseConfig = { apiKey: "AIzaSyC8Z5uv-7AiSEStw0jBYGvlsmVo9Ly63J4", authDomain: "health-dashboard-c880e.firebaseapp.com", projectId: "health-dashboard-c880e", storageBucket: "health-dashboard-c880e.appspot.com", messagingSenderId: "108872105823", appId: "1:108872105823:web:5a64271ad63cf76b83c0ea" };
                if (!firebaseConfig.apiKey) { appUI.landingPageContainer.innerHTML = '<p class="text-red-400 text-center">Firebase config missing.</p>'; return; }
                const firebaseApp = initializeApp(firebaseConfig);
                this.auth = getAuth(firebaseApp);
                this.db = getFirestore(firebaseApp);

                console.log('[DEBUG] init: Setting Firebase Auth persistence to LOCAL');
                // CRITICAL FIX: Set persistence to LOCAL to maintain auth state across redirects
                try {
                    const { browserLocalPersistence, setPersistence } = await import("https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js");
                    await setPersistence(this.auth, browserLocalPersistence);
                    console.log('[DEBUG] init: Persistence set successfully');
                } catch (error) {
                    console.error('[DEBUG] init: Failed to set persistence:', error);
                }

                this.addEventListeners();
                this.resolveAuthState();
            },

            async resolveAuthState() {
                console.log('[DEBUG] resolveAuthState: Starting auth resolution');
                // Since we're using popup auth, we just need to set up the auth state listener
                // No need to check for redirect results
                console.log('[DEBUG] resolveAuthState: Setting up auth state listener');
                onAuthStateChanged(this.auth, user => {
                    console.log('[DEBUG] onAuthStateChanged: Fired with user:', user ? user.uid : 'null');
                    if (user) {
                        this.setupUIForUser(user);
                    } else {
                        this.setupUIForGuest();
                    }
                });
            },

            setupUIForUser(user) {
                console.log('[DEBUG] setupUIForUser: Called for user', user.uid);
                console.log('[DEBUG] setupUIForUser: Current userId was', this.userId);

                if (this.userId === user.uid) {
                    console.warn('[DEBUG] setupUIForUser: Already set up for this user, skipping duplicate setup');
                    return;
                }

                this.userId = user.uid;
                const welcomeMessage = document.getElementById('welcomeMessage');
                if (user.displayName) {
                    welcomeMessage.textContent = `Welcome back, ${user.displayName.split(' ')[0]}!`;
                    // Update profile button with user's initial
                    const profileBtn = document.getElementById('profileBtn');
                    if (profileBtn) {
                        profileBtn.textContent = user.displayName.charAt(0).toUpperCase();
                    }
                }
                console.log('[DEBUG] setupUIForUser: Showing app container, hiding others');
                appUI.loadingContainer.classList.add('hidden');
                appUI.landingPageContainer.classList.add('hidden');
                appUI.appContainer.classList.remove('hidden');
                console.log('[DEBUG] setupUIForUser: Setting up realtime listeners');
                this.setupRealtimeListeners();
            },

            setupUIForGuest() {
                console.log('[DEBUG] setupUIForGuest: Showing landing page');
                this.userId = null;
                appUI.loadingContainer.classList.add('hidden');
                appUI.landingPageContainer.classList.remove('hidden');
                appUI.appContainer.classList.add('hidden');
                appUI.authError.textContent = '';  // Clear any previous errors
                if (this.unsubscribe) this.unsubscribe();
                if (this.userProfileUnsubscribe) this.userProfileUnsubscribe();
            },

            async signInWithGoogle() {
                console.log('[DEBUG] signInWithGoogle: Starting Google sign-in popup');
                const provider = new GoogleAuthProvider();
                try {
                    appUI.authError.textContent = '';  // Clear previous errors
                    console.log('[DEBUG] signInWithGoogle: Opening popup...');
                    const result = await signInWithPopup(this.auth, provider);
                    console.log('[DEBUG] signInWithGoogle: Sign-in successful, user:', result.user.uid);
                    // onAuthStateChanged will handle the UI update automatically
                } catch (error) {
                    console.error("[DEBUG] Google Sign-In Popup Error:", error);
                    console.error("[DEBUG] Error details:", error.code, error.message);

                    // Provide user-friendly error messages
                    if (error.code === 'auth/popup-closed-by-user') {
                        appUI.authError.textContent = 'Sign-in cancelled. Please try again.';
                    } else if (error.code === 'auth/popup-blocked') {
                        appUI.authError.textContent = 'Popup blocked by browser. Please allow popups for this site.';
                    } else {
                        appUI.authError.textContent = `Error during sign-in: ${error.message}`;
                    }
                }
            },

            setupRealtimeListeners() {
                if (this.unsubscribe) this.unsubscribe(); if (this.userProfileUnsubscribe) this.userProfileUnsubscribe();
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                const today = this.getTodayDateString();
                const todayDocRef = doc(this.db, 'artifacts', appId, 'users', this.userId, 'dailyLogs', today);
                this.unsubscribe = onSnapshot(todayDocRef, (docSnap) => { this.todayState = docSnap.exists() ? docSnap.data() : this.getInitialDailyState(); this.renderTodaysData(); });
                const userProfileRef = doc(this.db, 'artifacts', appId, 'users', this.userId, 'data', 'userProfile');
                this.userProfileUnsubscribe = onSnapshot(userProfileRef, (docSnap) => { this.userProfile = docSnap.exists() ? docSnap.data() : this.getInitialUserProfile(); this.renderUserProfile(); });
            },

            async saveData(dataType) {
                if (!this.userId) return; const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                try {
                    if (dataType === 'daily') { const today = this.getTodayDateString(); const docRef = doc(this.db, 'artifacts', appId, 'users', this.userId, 'dailyLogs', today); await setDoc(docRef, this.todayState, { merge: true }); }
                    else if (dataType === 'profile') { const docRef = doc(this.db, 'artifacts', appId, 'users', this.userId, 'data', 'userProfile'); await setDoc(docRef, this.userProfile, { merge: true }); }
                } catch (error) { console.error(`Error saving ${dataType} data:`, error); }
            },

            getInitialDailyState() { return { liquidCalories: 0, waterIntake: 0, excessCalories: 0, excessLog: [], todaysWorkouts: [] }; },
            getInitialUserProfile() { return { workoutStreak: 0, lastWorkoutDate: '' }; },
            getTodayDateString() { return new Date().toISOString().split('T')[0]; },

            addWorkout(workoutId) {
                if (workoutId === 'none') return;
                const workoutData = this.workouts[workoutId];
                if (!workoutData) return;
                if (!Array.isArray(this.todayState.todaysWorkouts)) this.todayState.todaysWorkouts = [];
                const newWorkout = { id: workoutId, instanceId: `workout_${Date.now()}`, name: workoutData.name, isComplete: false };
                if (workoutId === 'cardio') { newWorkout.cardioType = 'Running'; newWorkout.duration = 30; }
                else if (workoutId !== 'rest_day') { newWorkout.completedExercises = []; }
                this.todayState.todaysWorkouts.push(newWorkout);
                this.saveData('daily');
                appUI.workoutSelector.value = 'none';
            },

            removeWorkout(instanceId) { this.todayState.todaysWorkouts = this.todayState.todaysWorkouts.filter(w => w.instanceId !== instanceId); this.saveData('daily'); },
            updateCardioDetails(instanceId, field, value) { const workout = this.todayState.todaysWorkouts.find(w => w.instanceId === instanceId); if (!workout) return; if (field === 'duration') { workout[field] = parseInt(value, 10) || 0; } else { workout[field] = value; } this.saveData('daily'); },

            toggleExercise(instanceId, exerciseName, forceCheck = false) {
                const workout = this.todayState.todaysWorkouts.find(w => w.instanceId === instanceId);
                if (!workout) return;
                if (!workout.completedExercises) workout.completedExercises = [];
                const index = workout.completedExercises.indexOf(exerciseName);
                if (forceCheck) {
                    if (index === -1) workout.completedExercises.push(exerciseName);
                } else {
                    if (index > -1) workout.completedExercises.splice(index, 1);
                    else workout.completedExercises.push(exerciseName);
                }
                this.saveData('daily');
            },

            completeWorkout(instanceId) {
                const workout = this.todayState.todaysWorkouts.find(w => w.instanceId === instanceId); if (!workout || workout.isComplete) return;
                workout.isComplete = true;
                const isFirstCompletionToday = !this.todayState.todaysWorkouts.some(w => w.isComplete && w.instanceId !== instanceId);
                if (isFirstCompletionToday) {
                    const today = this.getTodayDateString(); const lastWorkout = this.userProfile.lastWorkoutDate;
                    if (!lastWorkout || lastWorkout !== today) {
                        const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1);
                        const lastWorkoutDateObj = lastWorkout ? new Date(lastWorkout + 'T00:00:00') : null;
                        if (lastWorkoutDateObj && lastWorkoutDateObj.toDateString() === yesterday.toDateString()) { this.userProfile.workoutStreak = (this.userProfile.workoutStreak || 0) + 1; }
                        else { this.userProfile.workoutStreak = 1; }
                    }
                    this.userProfile.lastWorkoutDate = today; this.saveData('profile');
                }
                this.saveData('daily');
            },

            addLiquidCalories(calories) { this.todayState.liquidCalories = (this.todayState.liquidCalories || 0) + calories; this.saveData('daily'); },
            addWater(glasses) { this.todayState.waterIntake = (this.todayState.waterIntake || 0) + glasses; this.saveData('daily'); },

            async addExcessCalories() {
                const descInput = document.getElementById('excessDescInput'); const desc = descInput.value.trim(); if (!desc) return;
                const logBtn = document.getElementById('logExcessBtn'), logText = document.getElementById('logExcessText'), logSpinner = document.getElementById('logExcessSpinner');
                logBtn.disabled = true; logText.textContent = 'Calculating...'; logSpinner.classList.remove('hidden');
                try {
                    const apiKey = "AIzaSyD6imNqPY8RfloxyOxxbYz_pvYScIxmkvk";
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                    const payload = { contents: [{ parts: [{ text: `Estimate calories for: ${desc}` }] }], generationConfig: { responseMimeType: "application/json", responseSchema: { type: "OBJECT", properties: { calories: { type: "NUMBER" } }, required: ["calories"] } } };
                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) throw new Error(`API error: ${response.statusText}`);
                    const result = await response.json(); const calories = JSON.parse(result.candidates[0].content.parts[0].text).calories;
                    if (calories > 0) { this.todayState.excessCalories = (this.todayState.excessCalories || 0) + calories; this.todayState.excessLog = this.todayState.excessLog || []; this.todayState.excessLog.push({ calories, desc }); descInput.value = ''; this.saveData('daily'); }
                    else throw new Error("Could not estimate calories.");
                } catch (error) { console.error("Calorie estimation failed:", error); alert("Sorry, I couldn't estimate the calories."); }
                finally { logBtn.disabled = false; logText.textContent = 'Calculate & Log'; logSpinner.classList.add('hidden'); }
            },

            renderTodaysData() {
                const state = this.todayState; if (!state) return;
                appUI.workoutStack.innerHTML = '';
                if (state.todaysWorkouts && state.todaysWorkouts.length > 0) {
                    state.todaysWorkouts.forEach(workout => {
                        let contentHtml = '';
                        if (workout.id === 'rest_day') { contentHtml = `<p class="text-center text-blue-500 p-4">Take a day to recover and recharge.</p>`; }
                        else if (workout.id === 'cardio') { contentHtml = `<div class="space-y-4 p-2"><div><label class="block text-sm font-semibold text-blue-800 mb-1">Cardio Type</label><select class="w-full px-3 py-2" onchange="app.updateCardioDetails('${workout.instanceId}', 'cardioType', this.value)"><option ${workout.cardioType === 'Running' ? 'selected' : ''}>Running</option><option ${workout.cardioType === 'Cycling' ? 'selected' : ''}>Cycling</option><option ${workout.cardioType === 'Swimming' ? 'selected' : ''}>Swimming</option><option ${workout.cardioType === 'Elliptical' ? 'selected' : ''}>Elliptical</option><option ${workout.cardioType === 'Rowing' ? 'selected' : ''}>Rowing</option><option ${workout.cardioType === 'Stair Climber' ? 'selected' : ''}>Stair Climber</option></select></div><div><label class="block text-sm font-semibold text-blue-800 mb-1">Duration (minutes)</label><input type="number" value="${workout.duration}" class="w-full px-3 py-2" onchange="app.updateCardioDetails('${workout.instanceId}', 'duration', this.value)"></div></div>`; }
                        else {
                            const workoutData = this.workouts[workout.id];
                            if (!workoutData || !workoutData.exercises) {
                                console.error(`[DEBUG] Missing workout data or exercises for workout.id: ${workout.id}`);
                                contentHtml = `<p class="text-center text-red-500 p-4">Error: Workout data not found</p>`;
                            } else {
                                contentHtml = `<div class="space-y-3">${workoutData.exercises.map(ex => {
                                    const isChecked = (workout.completedExercises || []).includes(ex.name);
                                    const repsStr = String(ex.reps || '');
                                    const isTimeBased = repsStr.includes('s') || repsStr.includes('hold');
                                    let actionHtml = '';
                                    if (isTimeBased) {
                                        const seconds = parseInt(repsStr) || 0;
                                        actionHtml = `<button class="btn btn-secondary btn-sm py-1 px-2 text-xs ml-4" onclick="app.startTimer('${workout.instanceId}', '${ex.name}', ${seconds})">Timer</button>`;
                                    }
                                    return `<div class="flex items-center p-3 bg-yellow-50 rounded-md hover:bg-yellow-100"><label class="flex items-center flex-grow cursor-pointer"><input type="checkbox" class="h-5 w-5 rounded mr-4" onchange="app.toggleExercise('${workout.instanceId}', '${ex.name}')" ${isChecked ? 'checked' : ''}><span class="notepad-text">${ex.name}</span></label><span class="text-blue-500 text-sm whitespace-nowrap">${ex.sets} x ${ex.reps}</span>${actionHtml}</div>`;
                                }).join('')}</div>`;
                            }
                        }
                        appUI.workoutStack.innerHTML += `<div class="border-2 border-blue-800 rounded-md p-4"><div class="flex justify-between items-center mb-4"><h3 class="font-bold text-lg notepad-header">${workout.name}</h3><button class="btn btn-danger btn-sm py-1 px-2 text-xs" onclick="app.removeWorkout('${workout.instanceId}')">Remove</button></div>${contentHtml}<button class="btn btn-primary mt-6 w-full" onclick="app.completeWorkout('${workout.instanceId}')" ${workout.isComplete ? 'disabled' : ''}>${workout.isComplete ? 'Completed!' : 'Mark as Complete'}</button></div>`;
                    });
                } else { appUI.workoutStack.innerHTML = `<p class="text-center text-blue-500 py-4">No workouts added for today.</p>`; }

                appUI.liquidCaloriesDisplay.textContent = state.liquidCalories || 0;
                appUI.liquidCaloriesBar.style.width = `${Math.min(100, ((state.liquidCalories || 0) / 500) * 100)}%`;
                appUI.waterIntakeDisplay.textContent = state.waterIntake || 0;
                appUI.waterIntakeBar.style.width = `${Math.min(100, ((state.waterIntake || 0) / 8) * 100)}%`;
                appUI.excessCaloriesDisplay.textContent = state.excessCalories || 0;
                appUI.excessList.innerHTML = (state.excessLog || []).map(item => `<div class="flex justify-between items-center bg-yellow-50 p-2 rounded-md"><span>${item.desc}</span><span class="font-semibold text-blue-800">${item.calories} kcal</span></div>`).join('');
            },
            renderUserProfile() {
                const profile = this.userProfile; if (!profile) return;
                appUI.workoutStreakDisplay.textContent = profile.workoutStreak || 0;
                appUI.lastWorkoutDate.textContent = profile.lastWorkoutDate ? `Last workout: ${new Date(profile.lastWorkoutDate + 'T00:00:00').toLocaleDateString()}` : 'No workouts yet.';
            },

            // --- TIMER LOGIC ---
            startTimer(instanceId, exerciseName, seconds) {
                this.currentTimerExercise = { instanceId, exerciseName };
                this.timerOriginalSeconds = seconds;
                this.timerSecondsLeft = seconds;
                this.isTimerRunning = false;
                appUI.timerExerciseName.textContent = exerciseName;
                this.updateTimerDisplay();
                appUI.timerControlBtn.textContent = 'Start';
                appUI.timerModal.classList.remove('hidden');
                setTimeout(() => {
                    const modalContent = appUI.timerModal.firstElementChild;
                    modalContent.style.opacity = 1;
                    modalContent.style.transform = 'scale(1)';
                }, 10);
            },
            controlTimer() {
                this.isTimerRunning = !this.isTimerRunning;
                if (this.isTimerRunning) {
                    appUI.timerControlBtn.textContent = 'Pause';
                    this.timerInterval = setInterval(() => this.tick(), 1000);
                } else {
                    appUI.timerControlBtn.textContent = 'Resume';
                    clearInterval(this.timerInterval);
                }
            },
            resetTimer() {
                clearInterval(this.timerInterval);
                this.isTimerRunning = false;
                this.timerSecondsLeft = this.timerOriginalSeconds;
                this.updateTimerDisplay();
                appUI.timerControlBtn.textContent = 'Start';
            },
            tick() {
                this.timerSecondsLeft--;
                this.updateTimerDisplay();
                if (this.timerSecondsLeft <= 0) {
                    clearInterval(this.timerInterval);
                    this.isTimerRunning = false;
                    this.playTimerSound();
                    this.toggleExercise(this.currentTimerExercise.instanceId, this.currentTimerExercise.exerciseName, true);
                    appUI.timerControlBtn.textContent = 'Done!';
                    appUI.timerControlBtn.disabled = true;
                    setTimeout(() => { this.closeTimer(); appUI.timerControlBtn.disabled = false; }, 1500);
                }
            },
            closeTimer() {
                clearInterval(this.timerInterval);
                const modalContent = appUI.timerModal.firstElementChild;
                modalContent.style.transform = 'scale(0.95)';
                modalContent.style.opacity = 0;
                setTimeout(() => appUI.timerModal.classList.add('hidden'), 200);
            },
            updateTimerDisplay() {
                appUI.timerDisplay.textContent = this.timerSecondsLeft;
            },
            playTimerSound() {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(880, audioContext.currentTime); // A5 note
                gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.0001, audioContext.currentTime + 1);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 1);
            },

            switchTab(tab) {
                appUI.dailyTabView.classList.toggle('active', tab === 'daily'); appUI.weeklyTabView.classList.toggle('active', tab === 'weekly');
                appUI.dailyTabBtn.classList.toggle('active', tab === 'daily'); appUI.weeklyTabBtn.classList.toggle('active', tab === 'weekly');
                if (tab === 'weekly') this.fetchWeeklyLog();
            },

            async fetchDailyLog(dateString) {
                if (!dateString || !this.userId) return;
                appUI.dailyLogContent.innerHTML = `<p class="text-center">Loading log for ${dateString}...</p>`;
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                const docRef = doc(this.db, 'artifacts', appId, 'users', this.userId, 'dailyLogs', dateString);
                const docSnap = await getDoc(docRef);
                if (docSnap.exists()) { this.renderDailyLog(docSnap.data()); }
                else { appUI.dailyLogContent.innerHTML = `<p class="text-center text-blue-400">No data found for this date.</p>`; }
            },

            renderDailyLog(data) {
                const workoutsHtml = (data.todaysWorkouts || []).filter(w => w.isComplete).map(w => `<li>${w.name}</li>`).join('');
                appUI.dailyLogContent.innerHTML = `<div class="space-y-2 text-blue-700"><p><strong>Liquid Calories:</strong> ${data.liquidCalories || 0} kcal</p><p><strong>Water Intake:</strong> ${data.waterIntake || 0} glasses</p><p><strong>Excess Calories:</strong> ${data.excessCalories || 0} kcal</p><p><strong>Workouts Completed:</strong></p><ul class="list-disc list-inside ml-4">${workoutsHtml || '<li>None</li>'}</ul></div>`;
            },

            async fetchWeeklyLog() {
                appUI.weeklyLogContent.innerHTML = `<p class="text-center">Calculating weekly summary...</p>`;
                const today = new Date(); const dayOfWeek = today.getDay();
                const startOfWeek = new Date(today); startOfWeek.setDate(today.getDate() - (dayOfWeek === 0 ? 6 : dayOfWeek - 1));
                let dates = []; for (let i = 0; i < 7; i++) { const date = new Date(startOfWeek); date.setDate(startOfWeek.getDate() + i); dates.push(date.toISOString().split('T')[0]); }
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                const logsRef = collection(this.db, 'artifacts', appId, 'users', this.userId, 'dailyLogs');
                const q = query(logsRef, where('__name__', '>=', dates[0]), where('__name__', '<=', dates[6]));
                const querySnapshot = await getDocs(q); let logs = {}; querySnapshot.forEach(doc => { logs[doc.id] = doc.data(); });
                this.renderWeeklyLog(dates, logs);
            },

            renderWeeklyLog(dates, logs) {
                let totalLiquid = 0, totalExcess = 0, workoutDays = 0;
                const daysHtml = dates.map(dateStr => {
                    const log = logs[dateStr]; const dayInitial = new Date(dateStr + 'T00:00:00').toLocaleDateString('en-US', { weekday: 'short' })[0]; let hasWorkout = false;
                    if (log) { totalLiquid += log.liquidCalories || 0; totalExcess += log.excessCalories || 0; if (log.todaysWorkouts && log.todaysWorkouts.some(w => w.isComplete)) { hasWorkout = true; workoutDays++; } }
                    return `<div class="text-center"><p class="text-sm text-blue-500">${dayInitial}</p><div class="w-8 h-8 rounded-full flex items-center justify-center mt-1 ${hasWorkout ? 'bg-blue-800 text-white' : 'bg-blue-200'}">${hasWorkout ? 'âœ“' : ''}</div></div>`;
                }).join('');
                const avgLiquid = workoutDays > 0 ? (totalLiquid / workoutDays).toFixed(0) : 0;
                appUI.weeklyLogContent.innerHTML = `<h3 class="font-bold text-lg mb-4 notepad-header">This Week's Summary</h3><div class="flex justify-around mb-6">${daysHtml}</div><div class="space-y-2 text-blue-700"><p><strong>Total Workout Days:</strong> ${workoutDays}</p><p><strong>Average Daily Liquid Calories:</strong> ${avgLiquid} kcal</p><p><strong>Total Weekly Excess Calories:</strong> ${totalExcess} kcal</p></div>`;
            },

            addEventListeners() {
                // Profile dropdown toggle
                const profileBtn = document.getElementById('profileBtn');
                const profileDropdown = document.getElementById('profileDropdown');

                if (profileBtn) {
                    profileBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        profileDropdown.classList.toggle('hidden');
                    });
                }

                // Close dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    if (profileDropdown && !profileDropdown.classList.contains('hidden')) {
                        profileDropdown.classList.add('hidden');
                    }
                });

                appUI.logoutBtn.addEventListener('click', () => {
                    profileDropdown.classList.add('hidden');
                    signOut(this.auth);
                });
                appUI.googleSignUpBtn.addEventListener('click', () => this.signInWithGoogle());
                appUI.googleSignInBtn.addEventListener('click', () => this.signInWithGoogle());
                appUI.workoutSelector.addEventListener('change', (e) => this.addWorkout(e.target.value));
                appUI.dailyTabBtn.addEventListener('click', () => this.switchTab('daily'));
                appUI.weeklyTabBtn.addEventListener('click', () => this.switchTab('weekly'));
                appUI.datePicker.addEventListener('change', (e) => this.fetchDailyLog(e.target.value));
                appUI.datePicker.value = this.getTodayDateString();
                // Timer Listeners
                appUI.timerControlBtn.addEventListener('click', () => this.controlTimer());
                appUI.timerResetBtn.addEventListener('click', () => this.resetTimer());
                appUI.timerDoneBtn.addEventListener('click', () => this.closeTimer());
            }
        };

        app.init();
        window.app = app;
    </script>
</body>

</html>